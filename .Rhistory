#PERMANOVA
#The only assumption of PERMANOVA is independence of samples (I think, but could be wrong here)
#permanova = adonis(formula=asv.filt.abundants.norm.hel~fertilization*species,strata=(design.keep$bloc/design.keep$replicate), data=design.keep, permutations=9999, method="bray")
#permanova$aov.tab$comparison = "root_fungi"
#all_spp_m = all_spp_m[,-c(6:8)]
all_spp_m.pcoa = data.frame(d[6:10,-1])
rownames(all_spp_m.pcoa) = all_spp_m[6:10,1]
#transpose
all_spp_m.pcoa=t(all_spp_m.pcoa)
#standardize
all_spp_m.pcoa.hel <-decostand(all_spp_m.pcoa, "hel")
#dissimilarity
all_spp_m.pcoa.hel.bray <-vegdist(all_spp_m.pcoa.hel, method="bray")
#Calculating PCoA
all_spp_m.pcoa.hel.bray.pcoa<-pcoa(dist(all_spp_m.pcoa.hel.bray))
#How many axes represent more variability (17)
bs = all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick
length(bs[bs>mean(bs)])
#PVE of first 2 axes (4.7% & 3.8%)
axis.1.2 = round((all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick/sum(all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick))[1:2],4)*100
axis.1.2
#Ploting the PCoAs - with fertilization as empty circles
#crops are "darkred","darkblue","darkorange
pcoa.plot = data.frame(all_spp_m.pcoa.hel.bray.pcoa$vectors[,1:2])
pcoa.plot[regexpr("St1",rownames(pcoa.plot))>0,3] = "St1" #circle
pcoa.plot[regexpr("PRM",rownames(pcoa.plot))>0,3] = "PRM" #triangle
pcoa.plot[regexpr("St2",rownames(pcoa.plot))>0,3] = "St2" #square
date = (unlist(strsplit(rownames(pcoa.plot),split = "_"))[seq(2,nrow(all_spp_m.pcoa)*3,by =3)])
pcoa.plot[,4] = ymd(date)
colnames(pcoa.plot) = c("axis1","axis2","Sampling","date")
p1=ggplot(pcoa.plot,aes(axis1,axis2)) +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)",shape = "Sampling Site", colour = "Sampling Date") +
geom_point(aes(colour=as.factor(date),shape = factor(Sampling))) +
scale_shape(solid = T) +
ylab(paste("Axis 2 (PVE:",axis.1.2[2],"%)",sep = "")) + xlab(paste("Axis 1 (PVE:",axis.1.2[1],"%)",sep = "")) +
scale_color_brewer(palette= "Spectral")
#
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
rm(list = ls())
setwd("/Users/jerry/Dropbox/CSBQ/shapiro")
#packages
#library(pals)
library(ggplot2)
#library(gridExtra)
#library(vegan)
#library(ape)
#library(lubridate)
library(phyloseq)
system("ls -1 results/org_results/*RefSeq_annot_organism.tsv >all.tsv")
all.tsv = read.table("all.tsv", stringsAsFactors = F)
all_spp = NULL
dates =  NULL
replicates = NULL
locations = NULL
full = NULL
#first loop is to subset the major species (over 1%)
#for(i in 1:nrow(all.tsv))
for(i in c(1:4,8:65))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
all_spp = c(all_spp,refseq.all[refseq.all[,1]>1,3]) #keep only top 1%
}
all_spp_m = data.frame(unique(sort(all_spp)),stringsAsFactors = F)
#for(i in 1:nrow(all.tsv))
for(i in c(1:4,8:65))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
for(j in 1:nrow(all_spp_m))
{
temp = refseq.all[refseq.all[,3] == all_spp_m[j,1],1]
if(length(temp) == 1) all_spp_m[j,i+1] = temp
if(length(temp) == 0) all_spp_m[j,i+1] = 0
}
replicate = substring(strsplit(all.tsv[i,1],split = "WatPhotz_")[[1]][2],4,4)
location = substring(strsplit(all.tsv[i,1],split = "Champ")[[1]][2],1,3)
date = strsplit(all.tsv[i,1],split = "-")[[1]][2]
dates = c(dates,date)
replicates = c(replicates,replicate)
locations = c(locations,location)
full = c(full,paste(location,date,replicate,sep = "_"))
}
#####phyloseq
####otu table
colnames(all_spp_m)[-1] = full
otumat = otu_table(all_spp_m[,-1],taxa_are_rows=T)
rownames(otumat) = all_spp_m[,1]
###FAKE tax table
taxmat = matrix(sample(letters,nrow(all_spp_m)*7, replace = TRUE), nrow = nrow(otumat), ncol = 7)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat = tax_table(taxmat)
###design
design = sample_data(data.frame(dates,replicates,locations,full,row.names=colnames(all_spp_m)[-1],stringsAsFactors = F))
###phyloseq object
physeq = phyloseq(otumat, taxmat,design)
###ordination (NMDS is the same as pcoa?)
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Set3")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
c(1:4,8:65)
dim(all_spp_m)
head(all_spp_m)
nrow(all.tsv)
system("ls -1 results/org_results/*RefSeq_annot_organism.tsv >all.tsv")
all.tsv = read.table("all.tsv", stringsAsFactors = F)
all_spp = NULL
dates =  NULL
replicates = NULL
locations = NULL
full = NULL
#first loop is to subset the major species (over 1%)
#for(i in 1:nrow(all.tsv))
for(i in c(1:4,8:65))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
all_spp = c(all_spp,refseq.all[refseq.all[,1]>1,3]) #keep only top 1%
print(i)
}
all_spp_m = data.frame(unique(sort(all_spp)),stringsAsFactors = F)
#for(i in 1:nrow(all.tsv))
for(i in c(1:4,8:65))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
for(j in 1:nrow(all_spp_m))
{
temp = refseq.all[refseq.all[,3] == all_spp_m[j,1],1]
if(length(temp) == 1) all_spp_m[j,i+1] = temp
if(length(temp) == 0) all_spp_m[j,i+1] = 0
}
replicate = substring(strsplit(all.tsv[i,1],split = "WatPhotz_")[[1]][2],4,4)
location = substring(strsplit(all.tsv[i,1],split = "Champ")[[1]][2],1,3)
date = strsplit(all.tsv[i,1],split = "-")[[1]][2]
dates = c(dates,date)
replicates = c(replicates,replicate)
locations = c(locations,location)
full = c(full,paste(location,date,replicate,sep = "_"))
print(i)
}
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
for(j in 1:nrow(all_spp_m))
{
temp = refseq.all[refseq.all[,3] == all_spp_m[j,1],1]
if(length(temp) == 1) all_spp_m[j,i+1] = temp
if(length(temp) == 0) all_spp_m[j,i+1] = 0
}
setwd("/Users/jerry/Dropbox/CSBQ/shapiro")
#packages
#library(pals)
library(ggplot2)
#library(gridExtra)
#library(vegan)
#library(ape)
#library(lubridate)
library(phyloseq)
system("ls -1 results/org_results/*RefSeq_annot_organism.tsv >all.tsv")
all.tsv = read.table("all.tsv", stringsAsFactors = F)
all_spp = NULL
dates =  NULL
replicates = NULL
locations = NULL
full = NULL
#first loop is to subset the major species (over 1%)
for(i in 1:nrow(all.tsv))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
all_spp = c(all_spp,refseq.all[refseq.all[,1]>1,3]) #keep only top 1%
}
all_spp_m = data.frame(unique(sort(all_spp)),stringsAsFactors = F)
for(i in 1:nrow(all.tsv))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
for(j in 1:nrow(all_spp_m))
{
temp = refseq.all[refseq.all[,3] == all_spp_m[j,1],1]
if(length(temp) == 1) all_spp_m[j,i+1] = temp
if(length(temp) == 0) all_spp_m[j,i+1] = 0
}
replicate = substring(strsplit(all.tsv[i,1],split = "WatPhotz_")[[1]][2],4,4)
location = substring(strsplit(all.tsv[i,1],split = "Champ")[[1]][2],1,3)
date = strsplit(all.tsv[i,1],split = "-")[[1]][2]
dates = c(dates,date)
replicates = c(replicates,replicate)
locations = c(locations,location)
full = c(full,paste(location,date,replicate,sep = "_"))
print(i)
}
dim(all_spp_m)
all_spp_m = all_spp_m[,-c(6:8)]
#####phyloseq
####otu table
colnames(all_spp_m)[-1] = full
otumat = otu_table(all_spp_m[,-1],taxa_are_rows=T)
rownames(otumat) = all_spp_m[,1]
###FAKE tax table
taxmat = matrix(sample(letters,nrow(all_spp_m)*7, replace = TRUE), nrow = nrow(otumat), ncol = 7)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat = tax_table(taxmat)
###design
design = sample_data(data.frame(dates,replicates,locations,full,row.names=colnames(all_spp_m)[-1],stringsAsFactors = F))
###phyloseq object
physeq = phyloseq(otumat, taxmat,design)
###ordination (NMDS is the same as pcoa?)
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Set3")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
dates
###get rid of samples st1 from sept15th, they are weid
all_spp_m = all_spp_m[,-c(6:8)]
dates = dates[-c(6:8)]
replicates = replicates[-c(6:8)]
locations = locations[-c(6:8)]
full = full[-c(6:8)]
#####phyloseq
####otu table
colnames(all_spp_m)[-1] = full
otumat = otu_table(all_spp_m[,-1],taxa_are_rows=T)
rownames(otumat) = all_spp_m[,1]
###FAKE tax table
taxmat = matrix(sample(letters,nrow(all_spp_m)*7, replace = TRUE), nrow = nrow(otumat), ncol = 7)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat = tax_table(taxmat)
###design
design = sample_data(data.frame(dates,replicates,locations,full,row.names=colnames(all_spp_m)[-1],stringsAsFactors = F))
###phyloseq object
physeq = phyloseq(otumat, taxmat,design)
###ordination (NMDS is the same as pcoa?)
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Set3")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
#PERMANOVA
#The only assumption of PERMANOVA is independence of samples (I think, but could be wrong here)
#permanova = adonis(formula=asv.filt.abundants.norm.hel~fertilization*species,strata=(design.keep$bloc/design.keep$replicate), data=design.keep, permutations=9999, method="bray")
#permanova$aov.tab$comparison = "root_fungi"
#all_spp_m = all_spp_m[,-c(6:8)]
all_spp_m.pcoa = data.frame(d[6:10,-1])
rownames(all_spp_m.pcoa) = all_spp_m[6:10,1]
#transpose
all_spp_m.pcoa=t(all_spp_m.pcoa)
#standardize
all_spp_m.pcoa.hel <-decostand(all_spp_m.pcoa, "hel")
#dissimilarity
all_spp_m.pcoa.hel.bray <-vegdist(all_spp_m.pcoa.hel, method="bray")
#Calculating PCoA
all_spp_m.pcoa.hel.bray.pcoa<-pcoa(dist(all_spp_m.pcoa.hel.bray))
#How many axes represent more variability (17)
bs = all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick
length(bs[bs>mean(bs)])
#PVE of first 2 axes (4.7% & 3.8%)
axis.1.2 = round((all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick/sum(all_spp_m.pcoa.hel.bray.pcoa$values$Broken_stick))[1:2],4)*100
axis.1.2
#Ploting the PCoAs - with fertilization as empty circles
#crops are "darkred","darkblue","darkorange
pcoa.plot = data.frame(all_spp_m.pcoa.hel.bray.pcoa$vectors[,1:2])
pcoa.plot[regexpr("St1",rownames(pcoa.plot))>0,3] = "St1" #circle
pcoa.plot[regexpr("PRM",rownames(pcoa.plot))>0,3] = "PRM" #triangle
pcoa.plot[regexpr("St2",rownames(pcoa.plot))>0,3] = "St2" #square
date = (unlist(strsplit(rownames(pcoa.plot),split = "_"))[seq(2,nrow(all_spp_m.pcoa)*3,by =3)])
pcoa.plot[,4] = ymd(date)
colnames(pcoa.plot) = c("axis1","axis2","Sampling","date")
p1=ggplot(pcoa.plot,aes(axis1,axis2)) +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)",shape = "Sampling Site", colour = "Sampling Date") +
geom_point(aes(colour=as.factor(date),shape = factor(Sampling))) +
scale_shape(solid = T) +
ylab(paste("Axis 2 (PVE:",axis.1.2[2],"%)",sep = "")) + xlab(paste("Axis 1 (PVE:",axis.1.2[1],"%)",sep = "")) +
scale_color_brewer(palette= "Spectral")
#
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
rm(list = ls())
setwd("/Users/jerry/Dropbox/CSBQ/shapiro")
#packages
#library(pals)
library(ggplot2)
#library(gridExtra)
#library(vegan)
#library(ape)
#library(lubridate)
library(phyloseq)
system("ls -1 results/org_results/*RefSeq_annot_organism.tsv >all.tsv")
all.tsv = read.table("all.tsv", stringsAsFactors = F)
all_spp = NULL
dates =  NULL
replicates = NULL
locations = NULL
full = NULL
#first loop is to subset the major species (over 1%)
for(i in 1:nrow(all.tsv))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
all_spp = c(all_spp,refseq.all[refseq.all[,1]>1,3]) #keep only top 1%
}
all_spp_m = data.frame(unique(sort(all_spp)),stringsAsFactors = F)
for(i in 1:nrow(all.tsv))
{
refseq.all = read.table(all.tsv[i,1],sep = "\t",stringsAsFactors = F)
for(j in 1:nrow(all_spp_m))
{
temp = refseq.all[refseq.all[,3] == all_spp_m[j,1],1]
if(length(temp) == 1) all_spp_m[j,i+1] = temp
if(length(temp) == 0) all_spp_m[j,i+1] = 0
}
replicate = substring(strsplit(all.tsv[i,1],split = "WatPhotz_")[[1]][2],4,4)
location = substring(strsplit(all.tsv[i,1],split = "Champ")[[1]][2],1,3)
date = strsplit(all.tsv[i,1],split = "-")[[1]][2]
dates = c(dates,date)
replicates = c(replicates,replicate)
locations = c(locations,location)
full = c(full,paste(location,date,replicate,sep = "_"))
}
###get rid of samples st1 from sept15th, they are weid
all_spp_m = all_spp_m[,-c(6:8)]
dates = dates[-c(6:8)]
replicates = replicates[-c(6:8)]
locations = locations[-c(6:8)]
full = full[-c(6:8)]
#####phyloseq
####otu table
colnames(all_spp_m)[-1] = full
otumat = otu_table(all_spp_m[,-1],taxa_are_rows=T)
rownames(otumat) = all_spp_m[,1]
###FAKE tax table
taxmat = matrix(sample(letters,nrow(all_spp_m)*7, replace = TRUE), nrow = nrow(otumat), ncol = 7)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat = tax_table(taxmat)
###design
design = sample_data(data.frame(dates,replicates,locations,full,row.names=colnames(all_spp_m)[-1],stringsAsFactors = F))
###phyloseq object
physeq = phyloseq(otumat, taxmat,design)
###ordination (NMDS is the same as pcoa?)
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Set3")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Spectral")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
labs(title = "Lake Champlain - PcoA (temp. 66 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Blues")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
?plot_ordination
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(shape = 16) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Blues")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(shape = 26) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Blues")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
warnings()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 26) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Blues")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Blues")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "BuGn")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "OrRd")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "PuRd")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "Accent")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "PCoA", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "PuOr")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_pcoa.pdf", onefile=FALSE)
dev.off()
###ordination (NMDS is the same as pcoa?)
physeq.ord <- ordinate(physeq, "NMDS", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - PcoA (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "PuOr")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_NMDS.pdf", onefile=FALSE)
dev.off()
physeq.ord <- ordinate(physeq, "NMDS", "bray")
p1 = plot_ordination(physeq, physeq.ord, type="samples", color="dates", title="taxa",shape="locations") +
theme_bw() +
geom_point(stroke = 2) +
labs(title = "Lake Champlain - NMDS (temp. 32 sps present at >1%)") +
scale_shape(solid = T) +
scale_color_brewer(palette= "PuOr")
dev.new()
p1
dev.print(device=pdf, "figures/Champlain_NMDS.pdf", onefile=FALSE)
dev.off()
