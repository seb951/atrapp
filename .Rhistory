all_spp_m_ggplot_top12.replicates_merged$fold_change_mean = 0
all_spp_m_ggplot_top12.replicates_merged$fold_change = 0
all_spp_m_ggplot_top12.replicates_merged
factor(all_spp_m_ggplot_top12.replicates_merged[,1])
all_spp_m_ggplot_top12.replicates_merged = fraction %>% group_by(all_spp_m_ggplot_top12$locations,all_spp_m_ggplot_top12$dates,all_spp_m_ggplot_top12$species) %>% summarise_all(mean)
all_spp_m_ggplot_top12.replicates_merged$fold_change_mean = 0
all_spp_m_ggplot_top12.replicates_merged$fold_change = 0
all_spp_m_ggplot_top12.replicates_merged$locations_f = 0
colnames(all_spp_m_ggplot_top12.replicates_merged) = c("locations","dates","species","fraction","fold_change_mean","fold_change","locations_f")
all_spp_m_ggplot_top12.replicates_merged = as.data.frame(all_spp_m_ggplot_top12.replicates_merged)
all_spp_m_ggplot_top12.replicates_merged$locations_f = factor(all_spp_m_ggplot_top12.replicates_merged[,1], levels=c('St1','St2','PRM'))
head(all_spp_m_ggplot_top12.replicates_merged$)
head(all_spp_m_ggplot_top12.replicates_merged)
####Fold change progression:
for(i in 1: nrow(all_spp_m_ggplot_top12.replicates_merged))
{
#per species
temp = all_spp_m_ggplot_top12.replicates_merged[all_spp_m_ggplot_top12.replicates_merged$species == all_spp_m_ggplot_top12.replicates_merged[i,3],]
#per location
temp = as.data.frame(temp)
temp2 = temp[temp$locations == all_spp_m_ggplot_top12.replicates_merged[i,1],]
#value divided by mean value
all_spp_m_ggplot_top12.replicates_merged$fold_change_mean[i] = log(all_spp_m_ggplot_top12.replicates_merged[i,4] / mean(temp2[,4], na.rm =T),10)
#value divided by Time 0
all_spp_m_ggplot_top12.replicates_merged$fold_change[i] = log(all_spp_m_ggplot_top12.replicates_merged[i,4] / temp2[temp2[,2]=="20160601",4],10)
}
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species),
data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") + ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species),
data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") + geom_line() + ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line(aes(y = fold_change, x = dates, colour = species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
# geom_line(aes(y = fold_change, x = dates, colour = species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
tu <- expand.grid(Land       = gl(2, 1, labels = c("DE", "BB")),
Altersgr   = gl(5, 1, labels = letters[1:5]),
Geschlecht = gl(2, 1, labels = c('m', 'w')),
Jahr       = 2000:2009)
tu
str(tu)
set.seed(42)
tu$Wert <- unclass(tu$Altersgr) * 200 + rnorm(200, 0, 10)
head(ty)
head(tu)
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line(),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line() +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 1,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_point(aes(y = fold_change, x = dates, colour = species,group=species),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
head(all_spp_m_ggplot_top12.replicates_merged)
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.title = element_text(colour="blue", size=10,face="bold"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(colour="blue", size=10,face="bold"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(colour=c("blue","red"), size=10,face="bold"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
?legend.text
?
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(colour=c("blue","red"), size=10,face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(colour=c("blue","red"),face="bolditalic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
?theme
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(colour=c("blue","red"),face="bold.italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
plot <- ggplot(mpg, aes(displ, hwy)) + geom_point()
plot
plot + theme(
panel.background = element_blank(),
axis.text = element_blank()
)
plot + theme(
axis.line = element_line(arrow = arrow())
)
plot + theme(
panel.background = element_rect(fill = "white"),
plot.margin = margin(2, 2, 2, 2, "cm"),
plot.background = element_rect(
fill = "grey90",
colour = "black",
size = 1
)
)
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="bold.italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_fill_manual(values = x(length(all_spp_five_m))) +
geom_bar(aes(y = fraction, x = samples, fill = species),
data = all_spp_m_ggplot_top12,stat="identity") + ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#PDF (dimensions in inches)
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f))
dev.print(device=pdf,"figures/Champlain_species_barplot.pdf", onefile=FALSE)
dev.off()
#PNG
png("figures/Champlain_species_barplot.png",width=10, res =400,height=7,units= 'in')
p1 + facet_grid(rows=vars(locations_f))
dev.off()
data("midwest", package = "ggplot2")
head(midwest)
gg <- ggplot(midwest, aes(x=area, y=poptotal)) +
geom_point(aes(col=state, size=popdensity)) +
geom_smooth(method="loess", se=F) + xlim(c(0, 0.1)) + ylim(c(0, 500000)) +
labs(title="Area Vs Population", y="Population", x="Area", caption="Source: midwest")
gg <- gg + guides(color=guide_legend("State"), size=guide_legend("Density"))  # modify legend title
plot(gg)
?scale_colour_manual
head(all_spp_m_ggplot_top12.replicates_merged)
?geom_line
all_spp_m_ggplot_top12.replicates_merged$cyano = 0
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype=cyano, colour = species,group=species),size = 3,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 1,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = "others"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 1,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("fraction of annotated species")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = "0"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 1,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = "0"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = cyano,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species,size = cyano),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = 1
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = 3
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = 3
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = 3
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species,size = cyano),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = 1
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = 3
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = 3
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = 3
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species,size = cyano),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = 1
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = 2
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = 2
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = 2
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species,size = cyano),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano
all_spp_m_ggplot_top12.replicates_merged$cyano = 1
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = 2
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = 2
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = 2
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, colour = species,group=species,size = cyano),data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
all_spp_m_ggplot_top12.replicates_merged$cyano = "0"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("Fold change (20160601=1)")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_discrete(name = "Species\n(dashed = cyano bacteria)")
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
1/1
log(1)
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_discrete(name = "Species(dashed = cyano bacteria)")
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(legend_title= "adads",aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual("adads",aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
+ guides(fill=guide_legend("my awesome title"))
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
# Base Plot
gg <- ggplot(midwest, aes(x=area, y=poptotal)) +
geom_point(aes(col=state, size=popdensity)) +
geom_smooth(method="loess", se=F) + xlim(c(0, 0.1)) + ylim(c(0, 500000)) +
labs(title="Area Vs Population", y="Population", x="Area", caption="Source: midwest")
g
gg
gg + labs(color="State", size="Densityqqwew")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="State", linetype="Densityqqwew")
p1
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species\n(dashed = cyano bacteria)", linetype="Densityqqwew")
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)")#, linetype="Densityqqwew")
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)")#, linetype="Densityqqwew") +
scale_linetype_discrete(guide=F)
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)")#, linetype="Densityqqwew") +
scale_linetype_discrete(name="cyano",guide=F)
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change (20160601 =0 )")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)") +
scale_linetype_discrete(name="cyano",guide=F)
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
#PDF (dimensions in inches)
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f))
dev.print(device=pdf,"figures/Champlain_species_foldchange.pdf", onefile=FALSE)
dev.off()
#PNG
png("figures/Champlain_species_foldchange.png",width=10, res =400,height=7,units= 'in')
p1 + facet_grid(rows=vars(locations_f))
dev.off()
#ggplot object
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change since Time 0")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)") +
scale_linetype_discrete(name="cyano",guide=F)
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
#PDF (dimensions in inches)
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f))
dev.print(device=pdf,"figures/Champlain_species_foldchange.pdf", onefile=FALSE)
dev.off()
#PNG
png("figures/Champlain_species_foldchange.png",width=10, res =400,height=7,units= 'in')
p1 + facet_grid(rows=vars(locations_f))
dev.off()
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."]
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp.|Dolichospermum circinale"]
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp.|Dolichospermum circinale"]
all_spp_m_ggplot_top12.replicates_merged[,3]
all_spp_m_ggplot_top12.replicates_merged$cyano = "0"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Anabaena sp."] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Dolichospermum circinale"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Microcystis aeruginosa"] = "cyano"
all_spp_m_ggplot_top12.replicates_merged$cyano[all_spp_m_ggplot_top12.replicates_merged[,3] == "Synechococcus sp."] = "cyano"
#ggplot object
x = colorRampPalette(brewer.pal(12,"Paired"))
p1=ggplot() + labs(title = "Lake Champlain - annotated species",fill = "Taxonomy") +
theme_bw() +
theme(legend.text = element_text(face="italic"),plot.title = element_text(hjust = 0.5, size=14, face="bold")) + scale_colour_manual(aesthetics = "colour",values = x(length(all_spp_five_m))) +
geom_line(aes(y = fold_change, x = dates, linetype = cyano, colour = species,group=species),size = 2,data = all_spp_m_ggplot_top12.replicates_merged,stat="identity") +
ylab("log10 Fold change since Time 0")  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(colour="Species (dashed = cyanobacteria)") +
scale_linetype_discrete(name="cyano",guide=F)
#dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f),scales="free")
#PDF (dimensions in inches)
dev.new(width=10, height=7,noRStudioGD = TRUE)
p1 + facet_grid(rows=vars(locations_f))
dev.print(device=pdf,"figures/Champlain_species_foldchange.pdf", onefile=FALSE)
dev.off()
#PNG
png("figures/Champlain_species_foldchange.png",width=10, res =400,height=7,units= 'in')
p1 + facet_grid(rows=vars(locations_f))
dev.off()
