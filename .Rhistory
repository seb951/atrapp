theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4,labels=comma) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3,labels=comma)
?annotate
winners
str(winners)
format(winners,big.mark  = ",")
x  =format(winners,big.mark  = ",")
str(x)
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = c("(669 genes)")
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = c(-1.8,-1.8), y.position = c(2.5,2.3),
counts = c(paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)",sep = ""),
paste("FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = "")))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4,labels=comma) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3)
setwd("/Users/jerry/Documents/CSBQ/shapiro")
#coordinates of the 3 circles
circle.positions <- data.frame(x = c(0, 0.866, -0.866),y = c(1, -0.5, -0.5),labels = c('St1', 'St2', 'PRM'))
#data
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = c("(669 genes)")
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = c(-1.8,-1.8), y.position = c(2.5,2.3),
counts = c(paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)",sep = ""),
paste("FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = "")))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3)
venn
dev.new()
venn
rectangle.data
rectangle.data = data.frame(x.position = c(-1.8,-1.8), y.position = c(2.5,2.3),
counts = c(paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""),
1))
rectangle.data
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
#  annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3)
()
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4)
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
#  annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3)
venn
circle.data$x.position,
circle.data$x.position
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3)
venn
dev.new()
venn
?annotate
rectangle.data = data.frame(x.position = -1.8, y.position = 2.5,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
rectangle.data
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position[1:2], y = rectangle.data$y.position[1:2], label = rectangle.data$counts[1:2], size = 3,hjust=0)
venn
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0)
dev.new()
venn
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=1)
venn
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=1)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.9)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.8)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.7)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.6)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.5)
rectangle.data = data.frame(x.position = 0, y.position = 2,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.5)
venn
rectangle.data = data.frame(x.position = 0, y.position = 2,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=-2)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=-2)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=-1)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=1)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=1.5)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=2)
venn + annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=c(2,2)
)
?geom_text
?annotate
circle.data
rectangle.data
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,hjust=0.5) +
geom_text(aes(label = counts,data = rectangle.data))
?geom_text
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = c("(669 genes)")
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = 0, y.position = -2,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
venn
#coordinates of the 3 circles
circle.positions <- data.frame(x = c(0, 0.866, -0.866),y = c(1, -0.5, -0.5),labels = c('St1', 'St2', 'PRM'))
#data
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = c("(669 genes)")
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = 0, y.position = 2.5,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
dev.new()
venn
rectangle.data = data.frame(x.position = 0, y.position = 3.5,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
venn
rectangle.data = data.frame(x.position = -2, y.position = 2.5,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
venn
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = c("(669 genes)")
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = -1.8, y.position = 2,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
venn
sition, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
venn
circle.data$counts_genes
circle.data
circle.data$counts[1]
circle.positions <- data.frame(x = c(0, 0.866, -0.866),y = c(1, -0.5, -0.5),labels = c('St1', 'St2', 'PRM'))
#data
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
winners
winners[3,2]
gsub("","",winners)
gsub("","",winners[,1])
gsub(" ","",winners[,1])
gsub(" ","",winners)
setwd("/Users/jerry/Documents/CSBQ/shapiro")
#coordinates of the 3 circles
circle.positions <- data.frame(x = c(0, 0.866, -0.866),y = c(1, -0.5, -0.5),labels = c('St1', 'St2', 'PRM'))
#data
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
winners[,1] = gsub(" ","",winners[,1])
winners[,2] = gsub(" ","",winners[,2])
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = "(669 genes)"
circle.data$counts[1] = "1,493 SNPs"
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = -1.8, y.position = 2.3,
counts = paste("ALL: ",winners[1,1]," SNPs (",winners[1,2]," genes)\n FILTERED: ",winners[2,1]," (",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3)
dev.new()
venn
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/venn_figure.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
?annotate
winners = read.table("results/dolicho/winners")
winners=format(winners,big.mark  = ",")
winners[,1] = gsub(" ","",winners[,1])
winners[,2] = gsub(" ","",winners[,2])
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = "(669 genes)"
circle.data$counts[1] = "1,493 SNPs"
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = -1.8, y.position = 2.3,
counts = paste(winners[1,1]," SNPs in",winners[1,2]," genes\n (Filtered:",winners[2,1],", ",winners[2,2],")",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,fontface =2)
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/venn_figure.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/figures/venn.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
rectangle.data = data.frame(x.position = -1.8, y.position = 2.3,
counts = paste(winners[1,1]," SNPs in ",winners[1,2]," genes\n (Filtered: ",winners[2,1],"SNPs in, ",winners[2,2]," genes)",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,fontface =2)
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/figures/venn.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
rectangle.data = data.frame(x.position = -1.8, y.position = 2.3,
counts = paste(winners[1,1]," SNPs in ",winners[1,2]," genes\n (Filtered: ",winners[2,1]," SNPs in, ",winners[2,2]," genes)",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,fontface =2)
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/figures/venn.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
rectangle.data = data.frame(x.position = -1.5, y.position = 2.3,
counts = paste(winners[1,1]," SNPs in ",winners[1,2]," genes\n (Filtered: ",winners[2,1]," SNPs in ",winners[2,2]," genes)",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 3,fontface =2)
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/figures/venn.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
circle.data = data.frame(x.position = c(0, 1.4, -1.4,0.8, -0.8, 0, 0),y.position = c(1.6, -1,-1, 0.25,0.25, -1.25, -0.2),
categories = c("St1","St2","PRM","St1-St2","St1-PRM","St2-PRM","St1-St2-PRM"),counts=winners[3:9,1],
counts_genes=paste("(",winners[3:9,2], ")", sep = ""),stringsAsFactors = F)
circle.data$counts_genes[1] = "(669 genes)"
circle.data$counts[1] = "1,493 SNPs"
circle.data$counts_modif = paste(circle.data$counts,circle.data$counts_genes)
rectangle.data = data.frame(x.position = -1.4, y.position = 2.3,
counts = paste(winners[1,1]," SNPs in ",winners[1,2]," genes\n (Filtered: ",winners[2,1]," SNPs in ",winners[2,2]," genes)",sep = ""))
####ggplot + geom_circle function
#geom_circle will draw the circles, with various options to make it prettier
#annotate will add text
venn = ggplot(circle.positions) +
geom_circle(aes(x0 = x, y0 = y, r = 1.5, fill = labels), alpha = .3, size = 1,colour="black") +
coord_fixed() +
theme_void() +
theme(legend.position = 'bottom') +
scale_fill_manual(values = c("#000000","#0000FF","#FF0000")) +
labs(fill = NULL) +
annotate("text", x = circle.data$x.position, y = circle.data$y.position+0.2, label = circle.data$counts_modif, size = 4) +
# annotate("text", x = circle.data$x.position[1:3], y = circle.data$y.position[1:3]-0.2, label = circle.data$counts_totals[1:3], size = 3) +
annotate("text", x = rectangle.data$x.position, y = rectangle.data$y.position, label = rectangle.data$counts, size = 4,fontface =2)
#save graph as pdf on the desktop
#dev.new(width=6, height=6,noRStudioGD = TRUE)
svg("results/dolicho/figures/venn.svg",width=6, height=6)
venn
#dev.print(device=pdf,"../results/dolicho/venn_figure.pdf", onefile=FALSE)
dev.off()
